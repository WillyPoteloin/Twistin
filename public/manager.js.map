{"version":3,"sources":["app/modules/manager/app.js","app/modules/manager/medias.js","app/modules/manager/route.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"public/manager.js","sourcesContent":["angular.module('app', ['ngRoute', 'formly', 'formlyBootstrap']);\n\nvar app = angular.module('app');\n\napp.value('keyword', '');","var app = angular.module('app');\n\napp.controller('medias', function ($scope, $http, $routeParams, $location) {\n\n\t// model d'un média\n\t$scope.media = {\n\t\tnom: '',\n\t\turl: '',\n\t\tnbChaine: 0\n\t};\n\n\t// on regarde si on est sur un media en particulier avec la route\n\tif($routeParams.id != undefined) {\n\t\t// on doit trouver le media en base\n\t\t$http.get('/medias/'+$routeParams.id).\n\t\tsuccess(function(data, status, headers, config) {\n\t\t\t$scope.media = data;\n\t\t}).\n\t\terror(function(data, status, headers, config){\n\t\t});\n\t}\n\n\t$scope.getAll = function(callback) {\t\n\t\t// on appel l'API pour récupérer les medias\n\t\t$http.get('/medias').\n\t\tsuccess(function(data, status, headers, config) {\n\t\t\t$scope.medias = data;\n\n\t\t\tcallback();\n\t\t}).\n\t\terror(function(data, status, headers, config) {\n\t\t});\n\t};\n\n\t$scope.add = function() {\n\t\tif($scope.form.$invalid) return false;\n\t\t$http.post('/medias/add', {media: $scope.media}).\n\t\tsuccess(function(data, status, headers, config) {\n\t\t\t// on vide l'objet pour l'ajout d'un média\n\t\t\t$scope.media.nom = '';\n\t\t\t$scope.media.url = '';\n\t\t\t$scope.media.nbChaine = 0;\n\t\t\t$location.path('/medias');\n\t\t}).\n\t\terror(function(data, status, headers, config) {\n\t\t\t// on vide l'objet pour l'ajout d'un média\n\t\t\t$scope.media.nom = '';\n\t\t\t$scope.media.url = '';\n\t\t\t$scope.media.nbChaine = 0;\n\t\t});\n\t};\n\t$scope.update = function() {\n\t\tif($scope.form.$invalid) return false;\n\t\t$http.post('/medias/update/'+$scope.media._id, {media: $scope.media}).\n\t\tsuccess(function(data, status, headers, config) {\n\t\t\t$location.path('/medias');\n\t\t}).\n\t\terror(function(data, status, headers, config) {\n\t\t});\n\t};\n\t$scope.delete = function() {\n\t\tif($scope.media._id != undefined) {\n\t\t\t$http.delete('/medias/delete/'+$scope.media._id).\n\t\t\tsuccess(function(data, status, headers, config) {\n\t\t\t\t// on vide l'objet pour l'ajout d'un média\n\t\t\t\t$scope.media._id = undefined;\n\t\t\t\t$scope.media.nom = '';\n\t\t\t\t$scope.media.url = '';\n\t\t\t\t$scope.media.nbChaine = 0;\n\t\t\t\t$location.path('/medias');\n\t\t\t}).\n\t\t\terror(function(data, status, headers, config) {\n\t\t\t\t// on vide l'objet pour l'ajout d'un média\n\t\t\t\t$scope.media._id = undefined;\n\t\t\t\t$scope.media.nom = '';\n\t\t\t\t$scope.media.url = '';\n\t\t\t\t$scope.media.nbChaine = 0;\n\t\t\t});\n\t\t}\n\t};\n\n\t// on doit récupérer tous les medias en base\n\t$scope.medias = $scope.getAll(function() {\n\n\t\t// liste des champs pour le formulaire d'un média\n\t\t$scope.fields = [\n\t\t\t{\n\t\t\t\ttype: 'input',\n\t\t\t\tkey: 'nom',\n\t\t\t\ttemplateOptions: {\n\t\t\t\t\tlabel: 'Nom du média',\n\t\t\t\t\tplaceholder: 'Youtube'\n\t\t\t\t},\n\t\t\t\tvalidators: {\n\t\t\t\t\tnotEmpty: function($viewValue, $modelValue, scope) {\n\t\t\t\t\t\tvar value = $modelValue || $viewValue;\n\t\t\t\t\t\treturn value !== '';\n\t\t\t\t\t},\n\t\t\t\t\tisUnique: function($viewValue, $modelValue, scope) {\n\t\t\t\t\t\tvar value = $modelValue || $viewValue;\n\t\t\t\t\t\t// On parcours chaque média pour voir si le nom existe déjà\n\t\t\t\t\t\tvar test = true;\n\t\t\t\t\t\t$.each($scope.medias, function(index, val) {\n\t\t\t\t\t\t\tif(val.nom == value && val._id != $scope.media._id) {\n\t\t\t\t\t\t\t\ttest = false;\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn test;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'input',\n\t\t\t\tkey: 'url',\n\t\t\t\ttemplateOptions: {\n\t\t\t\t\tlabel: 'Site du média',\n\t\t\t\t\tplaceholder: 'https://youtube.com'\n\t\t\t\t},\n\t\t\t\tvalidators: {\n\t\t\t\t\tnotEmpty: function($viewValue, $modelValue, scope) {\n\t\t\t\t\t\tvar value = $modelValue || $viewValue;\n\t\t\t\t\t\treturn value !== '';\n\t\t\t\t\t},\n\t\t\t\t\tisUrl: function($viewValue, $modelValue, scope) {\n\t\t\t\t\t\tvar value = $modelValue || $viewValue;\n\t\t\t\t\t\t// Vérifier que l'url est bien une url\n\t\t\t\t\t\tvar regexUrl = /^https?\\:\\/\\/.*\\..{2,4}$/;\n\t\t\t\t\t\tif(value.match(regexUrl) !== null) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tisUnique: function($viewValue, $modelValue, scope) {\n\t\t\t\t\t\tvar value = $modelValue || $viewValue;\n\t\t\t\t\t\t// On parcours chaque média pour voir si le nom existe déjà\n\t\t\t\t\t\tvar test = true;\n\t\t\t\t\t\t$.each($scope.medias, function(index, val) {\n\t\t\t\t\t\t\tif(val.url == value && val._id != $scope.media._id) {\n\t\t\t\t\t\t\t\ttest = false;\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn test;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t});\n\n});","var app = angular.module('app');\n\napp.config(function($routeProvider, $locationProvider) {\n\t$routeProvider.when('/', {\n\t\ttemplateUrl: 'manager/views/home.html'\n\t})\n\t.when('/home', {\n\t\tredirectTo: '/'})\n\t.when('/medias', {\n\t\ttemplateUrl: 'manager/views/medias.html'})\n\t.when('/medias/add', {\n\t\ttemplateUrl: 'manager/views/media.html'})\n\t.when('/medias/:id', {\n\t\ttemplateUrl: 'manager/views/media.html'})\n\t.when('/404', {\n\t\ttemplateUrl: 'manager/views/404.html'\n\t})\n\t.otherwise({\n\t\tredirectTo: '/404'\n\t});\n\n\t// $locationProvider.html5Mode(true);\n});"]}